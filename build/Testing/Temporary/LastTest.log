Start testing: Aug 05 12:14 CEST
----------------------------------------------------------
1/3 Testing: UnitTests
1/3 Test: UnitTests
Command: "/home/mbagarre/Bureau/STOAT/bin/unit_tests"
Directory: /home/mbagarre/Bureau/STOAT/build
"UnitTests" start time: Aug 05 12:14 CEST
Output:
----------------------------------------------------------
LOG: Total number of snarls : 1
LOG: Total number of paths : 2
LOG: chr : ref, number of snarl : 1
LOG: Total number of snarls : 1
LOG: Total number of paths : 3
LOG: chr : ref, number of snarl : 1
LOG: Total number of snarls : 1
LOG: Total number of paths : 3
LOG: chr : ref, number of snarl : 1
LOG: Total number of snarls : 1
LOG: Total number of paths : 2
LOG: chr : ref, number of snarl : 1
LOG: Total number of snarls : 1
LOG: Total number of paths : 2
LOG: chr : ref, number of snarl : 1
LOG: Total number of snarls : 1
LOG: Total number of paths : 2
LOG: chr : ref, number of snarl : 1
LOG: Total number of snarls : 2
LOG: Total number of paths : 4
LOG: chr : ref, number of snarl : 2
LOG: Total number of snarls : 3
LOG: Total number of paths : 6
LOG: chr : ref, number of snarl : 3
LOG: Total number of snarls : 1
LOG: Total number of paths : 3
LOG: chr : ref, number of snarl : 1
LOG: Total number of snarls : 1
LOG: Total number of paths : 6
LOG: chr : ref, number of snarl : 1
LOG: Total number of snarls : 1
LOG: Total number of paths : 8
LOG: chr : ref, number of snarl : 1
LOG: Total number of snarls : 2
LOG: Total number of paths : 5
LOG: chr : ref, number of snarl : 2
LOG: Total number of snarls : 1
LOG: Total number of paths : 4
LOG: chr : ref, number of snarl : 1
LOG: Total number of snarls : 1
LOG: Total number of paths : 5
LOG: chr : ref, number of snarl : 1
LOG: Total number of snarls : 2
LOG: Total number of paths : 4
LOG: chr : ref, number of snarl : 2
LOG: Total number of snarls : 2
LOG: Total number of paths : 5
LOG: chr : ref, number of snarl : 2
LOG: Binary phenotypes founds : 4 (Control : 2, Case : 2)
ERROR: Invalid header: FID ID PHENO
ERROR: Fatal error. Exiting.
<end of output>
Test time =   0.10 sec
----------------------------------------------------------
Test Failed.
"UnitTests" end time: Aug 05 12:14 CEST
"UnitTests" time elapsed: 00:00:00
----------------------------------------------------------

2/3 Testing: VcfSimuTest
2/3 Test: VcfSimuTest
Command: "/home/mbagarre/Bureau/STOAT/bin/vcf_simu_test"
Directory: /home/mbagarre/Bureau/STOAT/build
"VcfSimuTest" start time: Aug 05 12:14 CEST
Output:
----------------------------------------------------------
LOG: Starting snarl decomposition... 
LOG: Total number of snarls : 1524
LOG: Total number of paths : 3048
LOG: Snarl time decomposition : 2.171144 s
Missing SNARL in file1: 2_5

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
vcf_simu_test is a Catch v2.13.10 host application.
Run with -? for options

-------------------------------------------------------------------------------
Binary association tests vcf
  Snarl decomposition
-------------------------------------------------------------------------------
/home/mbagarre/Bureau/STOAT/tests/system/vcf_simu_test.cpp:154
...............................................................................

/home/mbagarre/Bureau/STOAT/tests/system/vcf_simu_test.cpp:155: FAILED:
  REQUIRE( run_test_snarl(stoat_command, output_dir, expected_dir, data_path, phenotype) )
with expansion:
  false

LOG: Binary phenotypes founds : 200 (Control : 100, Case : 100)
ERROR: Error: Invalid header format in file: ../output_binary/snarl_analyse.tsv
 > Expected: CHR\tSTART_POS\tEND_POS\tSNARL\tPATHS\tTYPE\tREF\tDEPTH
 > Got:      CHR\tSTART_POS\tEND_POS\tSNARL_HANDLEGRAPH\tSNARL\tPATHS\tTYPE\tREF\tDEPTH
ERROR: Fatal error. Exiting.
Command failed: ../bin/stoat vcf -s ../output_binary/snarl_analyse.tsv -v ../data/binary/merged_output.vcf.gz -b ../data/binary/phenotype.tsv --output ../output_binary
-------------------------------------------------------------------------------
Binary association tests vcf
  Without covariate
-------------------------------------------------------------------------------
/home/mbagarre/Bureau/STOAT/tests/system/vcf_simu_test.cpp:158
...............................................................................

/home/mbagarre/Bureau/STOAT/tests/system/vcf_simu_test.cpp:159: FAILED:
  REQUIRE( run_test_gwas(stoat_command, output_dir, expected_dir, data_path, phenotype, false) )
with expansion:
  false

LOG: Binary phenotypes founds : 200 (Control : 100, Case : 100)
ERROR: Error: Invalid header format in file: ../output_binary/snarl_analyse.tsv
 > Expected: CHR\tSTART_POS\tEND_POS\tSNARL\tPATHS\tTYPE\tREF\tDEPTH
 > Got:      CHR\tSTART_POS\tEND_POS\tSNARL_HANDLEGRAPH\tSNARL\tPATHS\tTYPE\tREF\tDEPTH
ERROR: Fatal error. Exiting.
Command failed: ../bin/stoat vcf -s ../output_binary/snarl_analyse.tsv -v ../data/binary/merged_output.vcf.gz -b ../data/binary/phenotype.tsv --covariate ../data/binary/covariate.tsv --covar-name CP1,SEX,CP3 --output ../output_binary
-------------------------------------------------------------------------------
Binary association tests vcf
  With covariate
-------------------------------------------------------------------------------
/home/mbagarre/Bureau/STOAT/tests/system/vcf_simu_test.cpp:162
...............................................................................

/home/mbagarre/Bureau/STOAT/tests/system/vcf_simu_test.cpp:163: FAILED:
  REQUIRE( run_test_gwas(stoat_command, output_dir, expected_dir_covar, data_path, phenotype, true) )
with expansion:
  false

LOG: Starting snarl decomposition... 
LOG: Total number of snarls : 1499
LOG: Total number of paths : 2998
LOG: Snarl time decomposition : 2.137165 s
Missing SNARL in file1: 1_4
-------------------------------------------------------------------------------
Quantitative trait tests vcf
  Snarl decomposition
-------------------------------------------------------------------------------
/home/mbagarre/Bureau/STOAT/tests/system/vcf_simu_test.cpp:175
...............................................................................

/home/mbagarre/Bureau/STOAT/tests/system/vcf_simu_test.cpp:176: FAILED:
  REQUIRE( run_test_snarl(stoat_command, output_dir, expected_dir, data_path, phenotype) )
with expansion:
  false

LOG: Quantitative phenotypes founds : 200
ERROR: Error: Invalid header format in file: ../output_quantitative/snarl_analyse.tsv
 > Expected: CHR\tSTART_POS\tEND_POS\tSNARL\tPATHS\tTYPE\tREF\tDEPTH
 > Got:      CHR\tSTART_POS\tEND_POS\tSNARL_HANDLEGRAPH\tSNARL\tPATHS\tTYPE\tREF\tDEPTH
ERROR: Fatal error. Exiting.
Command failed: ../bin/stoat vcf -s ../output_quantitative/snarl_analyse.tsv -v ../data/quantitative/merged_output.vcf.gz -q ../data/quantitative/phenotype.tsv --output ../output_quantitative
-------------------------------------------------------------------------------
Quantitative trait tests vcf
  Without covariate
-------------------------------------------------------------------------------
/home/mbagarre/Bureau/STOAT/tests/system/vcf_simu_test.cpp:179
...............................................................................

/home/mbagarre/Bureau/STOAT/tests/system/vcf_simu_test.cpp:180: FAILED:
  REQUIRE( run_test_gwas(stoat_command, output_dir, expected_dir, data_path, phenotype, false) )
with expansion:
  false

LOG: Quantitative phenotypes founds : 200
ERROR: Error: Invalid header format in file: ../output_quantitative/snarl_analyse.tsv
 > Expected: CHR\tSTART_POS\tEND_POS\tSNARL\tPATHS\tTYPE\tREF\tDEPTH
 > Got:      CHR\tSTART_POS\tEND_POS\tSNARL_HANDLEGRAPH\tSNARL\tPATHS\tTYPE\tREF\tDEPTH
ERROR: Fatal error. Exiting.
Command failed: ../bin/stoat vcf -s ../output_quantitative/snarl_analyse.tsv -v ../data/quantitative/merged_output.vcf.gz -q ../data/quantitative/phenotype.tsv --covariate ../data/quantitative/covariate.tsv --covar-name CP1,SEX,CP3 --output ../output_quantitative
-------------------------------------------------------------------------------
Quantitative trait tests vcf
  With covariate
-------------------------------------------------------------------------------
/home/mbagarre/Bureau/STOAT/tests/system/vcf_simu_test.cpp:183
...............................................................................

/home/mbagarre/Bureau/STOAT/tests/system/vcf_simu_test.cpp:184: FAILED:
  REQUIRE( run_test_gwas(stoat_command, output_dir, expected_dir_covar, data_path, phenotype, true) )
with expansion:
  false

===============================================================================
test cases: 2 | 2 failed
assertions: 6 | 6 failed

<end of output>
Test time =   4.47 sec
----------------------------------------------------------
Test Failed.
"VcfSimuTest" end time: Aug 05 12:14 CEST
"VcfSimuTest" time elapsed: 00:00:04
----------------------------------------------------------

3/3 Testing: GraphSimuTest
3/3 Test: GraphSimuTest
Command: "/home/mbagarre/Bureau/STOAT/bin/graph_simu_test"
Directory: /home/mbagarre/Bureau/STOAT/build
"GraphSimuTest" start time: Aug 05 12:14 CEST
Output:
----------------------------------------------------------
LOG: Start Sample haplotype analysis...
LOG: Sample haplotype time : 1.261437 s
LOG: Start GWAS analysis...
LOG: GWAS time analysis : 3.389182 s
LOG: Total time : 4.650709 s
===============================================================================
All tests passed (1 assertion in 1 test case)

<end of output>
Test time =   4.71 sec
----------------------------------------------------------
Test Passed.
"GraphSimuTest" end time: Aug 05 12:14 CEST
"GraphSimuTest" time elapsed: 00:00:04
----------------------------------------------------------

End testing: Aug 05 12:14 CEST
